function GetApplication(request) { return { request: request, gets: [], posts: [], puts: [], deletes: [], getRequestedPath: function () { return this.request.path; }, process: function (routes) { var path = this.getRequestedPath(); for (var i = 0; i < routes.length; i++) { var re = new RegExp(routes[i][0], 'i'); if (re.test(path)) { handler = routes[i][1]; break; } } if (handler) handler(this.request); }, Get: function (pattern, handler) { this.gets[this.gets.length] = [pattern, handler]; }, Post: function (pattern, handler) { this.posts[this.gets.length] = [pattern, handler]; }, Put: function (pattern, handler) { this.puts[this.gets.length] = [pattern, handler]; }, Delete: function (pattern, handler) { this.puts[this.gets.length] = [pattern, handler]; }, Run: function () { if (this.request.method === "GET") return this.process(this.gets); if (this.request.method === "POST") return this.process(this.posts); if (this.request.method === "PUT") return this.process(this.puts); if (this.request.method === "DELETE") return this.process(this.deletes); return; } }; } var app = GetApplication({"path":"/luca/movie/10","method":"GET","form":{},"query":{"id":"10"},"headers":{"connection":"keep-alive","keep-alive":"115","accept":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","accept-charset":"ISO-8859-1,utf-8;q=0.7,*;q=0.7","accept-encoding":"gzip,deflate","accept-language":"en-gb,en;q=0.5","host":"localhost","user-agent":"Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.2.12) Gecko/20101026 Firefox/3.6.12"},"serverVars":{"all_http":"HTTP_CONNECTION:keep-alive HTTP_KEEP_ALIVE:115 HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 HTTP_ACCEPT_CHARSET:ISO-8859-1,utf-8;q=0.7,*;q=0.7 HTTP_ACCEPT_ENCODING:gzip,deflate HTTP_ACCEPT_LANGUAGE:en-gb,en;q=0.5 HTTP_HOST:localhost HTTP_USER_AGENT:Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.2.12) Gecko/20101026 Firefox/3.6.12 ","all_raw":"Connection: keep-alive Keep-Alive: 115 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7 Accept-Encoding: gzip,deflate Accept-Language: en-gb,en;q=0.5 Host: localhost User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.2.12) Gecko/20101026 Firefox/3.6.12 ","appl_md_path":"/LM/W3SVC/1/ROOT/luca","appl_physical_path":"C:/inetpub/wwwroot/luca/","auth_type":"","auth_user":"","auth_password":"","logon_user":"","remote_user":"","cert_cookie":"","cert_flags":"","cert_issuer":"","cert_keysize":"","cert_secretkeysize":"","cert_serialnumber":"","cert_server_issuer":"","cert_server_subject":"","cert_subject":"","content_length":"0","content_type":"","gateway_interface":"CGI/1.1","https":"off","https_keysize":"","https_secretkeysize":"","https_server_issuer":"","https_server_subject":"","instance_id":"1","instance_meta_path":"/LM/W3SVC/1","local_addr":"::1","path_info":"/luca/movie/10","path_translated":"C:/inetpub/wwwroot/luca/movie/10","query_string":"id=10","remote_addr":"::1","remote_host":"::1","remote_port":"60600","request_method":"GET","script_name":"/luca/movie/10","server_name":"localhost","server_port":"80","server_port_secure":"0","server_protocol":"HTTP/1.1","server_software":"Microsoft-IIS/7.5","url":"/luca/movie/10","http_connection":"keep-alive","http_keep_alive":"115","http_accept":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","http_accept_charset":"ISO-8859-1,utf-8;q=0.7,*;q=0.7","http_accept_encoding":"gzip,deflate","http_accept_language":"en-gb,en;q=0.5","http_host":"localhost","http_user_agent":"Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.2.12) Gecko/20101026 Firefox/3.6.12"},"cookies":{}}); app.Get("movie/\d*", function (req) { return "hello cruel world" + req.query.id; }); app.Run();